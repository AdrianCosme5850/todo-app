{"ast":null,"code":"var _jsxFileName = \"/home/adrian/codefellows/401/todo-app/src/context/authContext.jsx\",\n  _s = $RefreshSig$();\nimport React from 'react';\nimport cookie from 'react-cookies';\nimport jwt_decode from 'jwt-decode';\nimport { useState, createContext, useEffect } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const AuthContext = /*#__PURE__*/createContext();\nconst testUsers = {\n  Administrator: {\n    password: 'admin',\n    name: 'Administrator',\n    token: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuYW1lIjoiQWRtaW5pc3RyYXRvciIsInJvbGUiOiJhZG1pbiIsImNhcGFiaWxpdGllcyI6IlsnY3JlYXRlJywncmVhZCcsJ3VwZGF0ZScsJ2RlbGV0ZSddIiwiaWF0IjoxNTE2MjM5MDIyfQ.pAZXAlTmC8fPELk2xHEaP1mUhR8egg9TH5rCyqZhZkQ'\n  },\n  Editor: {\n    password: 'editor',\n    name: 'Editor',\n    token: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuYW1lIjoiRWRpdG9yIiwicm9sZSI6ImVkaXRvciIsImNhcGFiaWxpdGllcyI6IlsncmVhZCcsJ3VwZGF0ZSddIiwiaWF0IjoxNTE2MjM5MDIyfQ.3aDn3e2pf_J_1rZig8wj9RiT47Ae2Lw-AM-Nw4Tmy_s'\n  },\n  Writer: {\n    password: 'writer',\n    name: 'Writer',\n    token: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuYW1lIjoiV3JpdGVyIiwicm9sZSI6IndyaXRlciIsImNhcGFiaWxpdGllcyI6IlsnY3JlYXRlJ10iLCJpYXQiOjE1MTYyMzkwMjJ9.dmKh8m18mgQCCJp2xoh73HSOWprdwID32hZsXogLZ68'\n  },\n  User: {\n    password: 'user',\n    name: 'User',\n    token: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuYW1lIjoiVXNlciIsInJvbGUiOiJ1c2VyIiwiY2FwYWJpbGl0aWVzIjoiWydyZWFkJ10iLCJpYXQiOjE1MTYyMzkwMjJ9.WXYvIKLdPz_Mm0XDYSOJo298ftuBqqjTzbRvCpxa9Go'\n  }\n};\nconst AuthContextProvider = function (props) {\n  _s();\n  let [loggedIn, setLoggedIn] = useState(false);\n  let [capabilities, setCapabilities] = useState([]);\n  let [error, setError] = useState(null);\n  let login = (username, password) => {\n    const User = testUsers[username];\n    if (User.password === password) {\n      cookie.save('auth', User);\n      setLoggedIn(true);\n      setCapabilities(jwt_decode(User.token).capabilities);\n    } else {\n      setLoggedIn(false);\n      setCapabilities([]);\n      setError('bad creds');\n    }\n  };\n  let validateToken = token => {\n    try {\n      let User = jwt_decode(token);\n      console.log(User);\n      setLoggedIn(true);\n      setCapabilities(User.capabilities);\n    } catch (e) {\n      setLoggedIn(false);\n      setCapabilities([]);\n      console.log('bad token');\n    }\n  };\n  let logout = () => {\n    setLoggedIn(false);\n    setCapabilities([]);\n  };\n  useEffect(() => {\n    const cookieToken = cookie.load('auth');\n    validateToken(cookieToken.token);\n  }, []);\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      loggedIn,\n      setLoggedIn,\n      capabilities,\n      setCapabilities,\n      error,\n      setError,\n      login,\n      logout\n    },\n    children: props.children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 75,\n    columnNumber: 9\n  }, this);\n};\n_s(AuthContextProvider, \"TU4Y2/DY7MPBSgx+KLZQhA6AnPg=\");\n_c = AuthContextProvider;\nexport default AuthContextProvider;\nvar _c;\n$RefreshReg$(_c, \"AuthContextProvider\");","map":{"version":3,"names":["React","cookie","jwt_decode","useState","createContext","useEffect","AuthContext","testUsers","Administrator","password","name","token","Editor","Writer","User","AuthContextProvider","props","loggedIn","setLoggedIn","capabilities","setCapabilities","error","setError","login","username","save","validateToken","console","log","e","logout","cookieToken","load","children"],"sources":["/home/adrian/codefellows/401/todo-app/src/context/authContext.jsx"],"sourcesContent":["import React from 'react';\r\nimport cookie from 'react-cookies';\r\nimport jwt_decode from 'jwt-decode';\r\nimport { useState, createContext, useEffect} from 'react';\r\n\r\nexport const AuthContext = createContext();\r\n\r\nconst testUsers = {\r\n    Administrator: {\r\n      password: 'admin',\r\n      name: 'Administrator',\r\n      token: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuYW1lIjoiQWRtaW5pc3RyYXRvciIsInJvbGUiOiJhZG1pbiIsImNhcGFiaWxpdGllcyI6IlsnY3JlYXRlJywncmVhZCcsJ3VwZGF0ZScsJ2RlbGV0ZSddIiwiaWF0IjoxNTE2MjM5MDIyfQ.pAZXAlTmC8fPELk2xHEaP1mUhR8egg9TH5rCyqZhZkQ'\r\n    },\r\n    Editor: {\r\n      password: 'editor',\r\n      name: 'Editor',\r\n      token: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuYW1lIjoiRWRpdG9yIiwicm9sZSI6ImVkaXRvciIsImNhcGFiaWxpdGllcyI6IlsncmVhZCcsJ3VwZGF0ZSddIiwiaWF0IjoxNTE2MjM5MDIyfQ.3aDn3e2pf_J_1rZig8wj9RiT47Ae2Lw-AM-Nw4Tmy_s'\r\n    },\r\n    Writer: {\r\n      password: 'writer',\r\n      name: 'Writer',\r\n      token: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuYW1lIjoiV3JpdGVyIiwicm9sZSI6IndyaXRlciIsImNhcGFiaWxpdGllcyI6IlsnY3JlYXRlJ10iLCJpYXQiOjE1MTYyMzkwMjJ9.dmKh8m18mgQCCJp2xoh73HSOWprdwID32hZsXogLZ68'\r\n    },\r\n    User: {\r\n      password: 'user',\r\n      name: 'User',\r\n      token: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuYW1lIjoiVXNlciIsInJvbGUiOiJ1c2VyIiwiY2FwYWJpbGl0aWVzIjoiWydyZWFkJ10iLCJpYXQiOjE1MTYyMzkwMjJ9.WXYvIKLdPz_Mm0XDYSOJo298ftuBqqjTzbRvCpxa9Go'\r\n    },\r\n  };\r\n\r\n\r\n\r\n  const AuthContextProvider = function (props){\r\n    let [loggedIn, setLoggedIn] = useState(false);\r\n    let [capabilities, setCapabilities] = useState([]);\r\n    let [error, setError] = useState(null);\r\n    let login = (username, password) => {\r\n        const User = testUsers[username];\r\n\r\n        if(User.password === password){\r\n            cookie.save('auth', User);\r\n            setLoggedIn(true)\r\n            setCapabilities(jwt_decode(User.token).capabilities)\r\n        } else {\r\n            setLoggedIn(false)\r\n            setCapabilities([]);\r\n            setError('bad creds');\r\n        }\r\n      }\r\n    \r\n      let validateToken = (token) => {\r\n        try{\r\n            let User = jwt_decode(token)\r\n            console.log(User)\r\n            setLoggedIn(true)\r\n            setCapabilities(User.capabilities)\r\n        } catch(e){\r\n            setLoggedIn(false)\r\n            setCapabilities([]);\r\n            console.log('bad token');\r\n        }\r\n      }\r\n\r\n      let logout = () => {\r\n        setLoggedIn(false)\r\n        setCapabilities([]);\r\n      }\r\n\r\n      useEffect(() => {\r\n        const cookieToken = cookie.load('auth');\r\n        validateToken(cookieToken.token);\r\n      }, [])\r\n\r\n    return (\r\n        <AuthContext.Provider value={{ loggedIn, setLoggedIn, capabilities, setCapabilities, error, setError, login, logout }}>\r\n            {props.children}\r\n        </AuthContext.Provider>\r\n    )\r\n  }\r\n\r\n  export default AuthContextProvider;"],"mappings":"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"},"metadata":{},"sourceType":"module"}